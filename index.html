<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="个人博客">
<meta name="keywords" content="怪力">
<meta property="og:type" content="website">
<meta property="og:title" content="怪力">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="怪力">
<meta property="og:description" content="个人博客">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="怪力">
<meta name="twitter:description" content="个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>怪力</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">怪力</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">个人博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/22/account/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/22/account/" itemprop="url">用户账户</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-22T16:19:00+08:00">
                2019-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在去年的时候做了用户虚拟账户的设计，后来接手订单后，</span><br><span class="line">断断续续订单出了很多事情，相反账户好像很稳，</span><br><span class="line">就算在订单出现问题的情况下，也没有让公司产生损失，总结下账户的一些情况。</span><br></pre></td></tr></table></figure>
<h2 id="基于TCC的账户设计"><a href="#基于TCC的账户设计" class="headerlink" title="基于TCC的账户设计"></a>基于TCC的账户设计</h2><p>账户本身是个金融性很强的操作，公平和稳定才是最大的成功，两段式提交可以尽量保证账户的稳定性。并且就算再出现情况下，也不至于让公司损失资产。<br>因为账户本身是依赖订单的成功性的，在最终一致性的要求下，需要有可变的账户流水状态进行预扣和返还，同时流水还需要记录账户的变动，包括总金额、每个账户的当前余额、消费额度、以及期末余额，不要觉得没必要记录那么多，当排查问题的时候，你会发现很多好处，记录一目了然，就算真的出现问题，重新扣回来也不是问题。</p>
<p>预扣款：当下单时，订单服务会发送相应的扣款金额，扣款账户等进行预扣款。<br>扣款：当订单成功时，订单服务会发送相应异步消息，收到消息后，对相应的订单服务进行二次确认，在一系列确认完成之后，进行变更状态操作，这个时候才能算一笔流水成功入库，继续通知相关业务服务进行下一步操作。<br>返还：一般预扣款之后，会有延迟任务进行返回操作，比如1分钟内，如果订单还是未被确认的，就需要再次确认订单服务的订单是否还是有效订单，把相应的钱款返回到账户，当然这里和订单机制有关，有些系统的设计是订单有效期内，下单还是会返回当前订单的，这里就需要相应的服务进行方案确认了。</p>
<p>预扣款的时候排队扣款问题：预扣款应当是同步和幂等的，不会对相同的订单重复扣款，对于用户来讲扣款应该是有序的<br>扣款：扣款应该是经过准确校验的、幂等的同一个订单不能扣款两次<br>返还：返还的时候必须要确认订单的相关信息，看看到底是返还是扣款，同样这里也是需要幂等的</p>
<p>当然还有很多的账户功能，就不在这里做叙述了，主要是为了描述一些TCC的设计。</p>
<h2 id="订单和账户的对账"><a href="#订单和账户的对账" class="headerlink" title="订单和账户的对账"></a>订单和账户的对账</h2><p>对账可以帮忙发现很多问题，不管是订单的还是账户，如果两边收入支出不平衡，可以发现一些错误的订单或者账户流水。<br>可以发现问题的方式都是好方式，不管是从财务上还是从技术本身。<br>对账就需要设计相应的流水记录，每个项目的对账方式可能都有不同的地方，所以在设计账户流水的尽量将对账的相关考虑进去。</p>
<h2 id="报警和日志"><a href="#报警和日志" class="headerlink" title="报警和日志"></a>报警和日志</h2><p>相关的报警和日志还是比不可缺的，没有相关健全的保障措施，会让查找问题和排除等有很大的局限性，没有及时发现问题的措施，会让损失持续扩大化，可能最后不得不停服务采取这样的措施来解决。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/19/applePay/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/19/applePay/" itemprop="url">苹果支付</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-19T14:10:07+08:00">
                2019-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="苹果支付的一些问题"><a href="#苹果支付的一些问题" class="headerlink" title="苹果支付的一些问题"></a>苹果支付的一些问题</h2><p>1.苹果支付的传递只能通过app本身传递，存在了很多的不确定性，在应用崩溃等情况时，会丢失订单号<br>2.传输问题，app客户单的网略情况没有服务器的传输稳定，在网络波动的情况下，会出现接收不到验证信息的情况<br>3.服务器向苹果验证时的网络问题，这里概率不是很高，但是偶尔也是有的，验证会有超时等等的现象<br>4.苹果服务器返回问题，偶尔存在服务器返回的时候，丢失了一部校验数据<br>5.订单返回商品存在多个订单的商品信息，连续多次下单或者曾经订单处理不及时的情况下，苹果会存在合并订单的情况</p>
<h2 id="针对苹果订单的一些处理"><a href="#针对苹果订单的一些处理" class="headerlink" title="针对苹果订单的一些处理"></a>针对苹果订单的一些处理</h2><p>1.对于丢失订单号的情况，需要针对用户本身获取相应订单，验证订单商品一致，对商品等校验后，将相应权益给到用户账户<br>2.保证重试，这里有两个地方，app与服务器之间的重试，服务器与苹果服务器之间的重试。<br>与app协定重试策略，让app添加定时器，每隔一段时间重试一次，并有一个最终重试机制。超过最终重试之后，每次app打开的时候验证向服务端验证等。<br>服务器验证方面则需要在网络错误的情况下记录到库，后续去做重试操作，最好标记次数等。<br>3.苹果存在合并订单的情况，需要去查询用户购买的相关产品，做好产品编号和交易号的校验，进行异步补偿处理。（ps:谁也不知道接手的项目之前卖过什么类型的商品）</p>
<h2 id="事务问题"><a href="#事务问题" class="headerlink" title="事务问题"></a>事务问题</h2><p>订单情况下，事务问题有时候排查起来比较困难，特别又涉及了分布式调用情况。<br>1.事务拆分，尽量不要在订单流程中使用大事务，如果有大事务，尽量拆分到不同的小事务<br>2.事务引发的脏读问题，因为事务本身具有隔离性，当事务没有提交的时候，会导致读取的情况不一样，<br>在订单的强一致性下，这样的情况显然不能接受。可以在拆分细的事务后，使用高可用消息中间件，解决最终一致性问题</p>
<h2 id="缓存问题"><a href="#缓存问题" class="headerlink" title="缓存问题"></a>缓存问题</h2><p>在和订单相关的服务调用的时候容易产生，特别在和事务的情况融在一起时，就更加复杂。我刚接手代码的时候，很多地方的写法都排除了这样的况，导致问题出现频繁，但是对于缓存的情况，并没有通用的解决方案，只能在相应的情况下做出处理。</p>
<h2 id="异步化问题"><a href="#异步化问题" class="headerlink" title="异步化问题"></a>异步化问题</h2><p>1.异步是个通用的解决模型，能通过异步消息解决很多问题。比如账户和订单之间。<br>这里要说的是异步化不要在事务中进行，我早期接手代码的时候，发现很多消息竟然是嵌入在事务里面的，<br>这里就为消息本身带来很多不确定性，发送应该在事务完整结束之后。</p>
<h2 id="幂等"><a href="#幂等" class="headerlink" title="幂等"></a>幂等</h2><p>保证幂等是基本要求</p>
<h2 id="分布式问题"><a href="#分布式问题" class="headerlink" title="分布式问题"></a>分布式问题</h2><p>需要处理好对于分布式相关的调用问题，以及分布式锁使用的情况</p>
<h2 id="订单情况排查"><a href="#订单情况排查" class="headerlink" title="订单情况排查"></a>订单情况排查</h2><p>日志入库：相应的关键位置的日志应该入库操作，毕竟是涉及用户金钱的，相关位置还是要记录一下的<br>报警：接入相应的监控，当出现问题时，可以及时的处理，不造成损失扩大<br>这里具体的方案应该每个公司都会有一些相应的基础设施，可以对接相应的部门获取，如果是一些创业型公司，可以用db、邮件服务等再相关位置做发送也是可以的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/13/网络基础/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/13/网络基础/" itemprop="url">网络基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-13T10:36:33+08:00">
                2019-02-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="网络分层"><a href="#网络分层" class="headerlink" title="网络分层"></a>网络分层</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">应用层: DHCP、HTTP、HTTPS、RTMP、P2P、DNS、GTP、RPC</span><br><span class="line">传输层: UDP、TCP</span><br><span class="line">网络层: ICMP、IP、OSPF、BGP、IPSEC、GRE</span><br><span class="line">数据链路层: ARP、VLAN、STP</span><br><span class="line">物理层: 网络跳线</span><br></pre></td></tr></table></figure>
<p><a href="https://zh.wikipedia.org/wiki/TCP/IP%E5%8D%8F%E8%AE%AE%E6%97%8F" target="_blank" rel="noopener">协议套件</a></p>
<h3 id="举例网络正常传输过程"><a href="#举例网络正常传输过程" class="headerlink" title="举例网络正常传输过程"></a>举例网络正常传输过程</h3><p>1.一个请求从浏览器请求服务器时，服务器收到了浏览器的请求后<br>2.内容、http头、tcp头、ip头、mac头被包装后进行发送<br>3.首先被摘掉的是mac头、ARP会发出广播查看这个包能被哪位仁兄接收<br>4.当包被下层接收后，会取下ip头查看是否是发给我自己的，如果是就留下，不是就进行转发<br>5.如果是自己的，则丢给应用，因为tcp里面有端口号<br>6.这个应用估计就是个浏览器了，取下http头，根据内容展示相应的内容<br><a href="https://zh.wikipedia.org/wiki/%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">参考资料 ARP</a></p>
<p><img src="/2019/02/13/网络基础/网络传输过程.jpg" alt=""><br>总结:层与层的关系更是包含关系，每层其实都是完整的包，只是每层对应做的事情不一样而已。可以没有上层，但是不能没有下层。</p>
<p>但是这样还有很多问题，比如<br>1.ARP只能支持同一个网段的通信<br>2.IP地址是怎么来的，又是怎么没的<br>3.等等…</p>
<h3 id="媒体访问控制-MAC"><a href="#媒体访问控制-MAC" class="headerlink" title="媒体访问控制 MAC"></a>媒体访问控制 MAC</h3><p>当电脑配置好ip地址，通过集线器连接之后，就能正常广播网络包了，<br>但是这里不能乱，要制定收发的规则（谁先发，谁后发等。），错误处理等等，这就需要MAC来解决。这里有个名词叫做<strong>多路访问</strong>。至于发给谁，谁接收，就需要mac地址来解决，这玩意号称全世界唯一不重复。类似于身份证。在发送的时候，带上目标的MAC地址和源MAC地址，以及相应的类型（ARP;IP数据报），就能被收到了。还有一个问题，就是在以太网中，知道了ip地址，确不知道mac地址，那怎么办，这里就需要ARP，广播出去，谁是这个ip的，谁来回答，收到回到后，将包发送过去。然后将目标ip和mac缓存起来。<br><img src="/2019/02/13/网络基础/MAC网络包格式.jpg" alt=""><br><img src="/2019/02/13/网络基础/ARP包详情.jpg" alt=""><br>总结下：<br>1、mac层主要解决了多路访问控制，接收靠的是网络格式<br>2、ARP主要是广播形式</p>
<h3 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h3><p>linux有自己设置ip的命名，比如ifconfig。<br>但是也不是怎么配置都可以的，如果配置的ip不正确，容易造成网络包发送不出去。<br>比如身处网络192.168.1.x的网络环境，私自将ip配置了10.100.158.47，如果需要将网络包发送到192.168.1.x上，网络包是出不去的。首先这里不知道目标的mac的地址，跨网段调用需要网关，还需要配置网关的地址，才能将包发到对应的机器上。<br>所以配置ip是一件比较麻烦的事情，才有了dhcp简称动态主机配置协议。<br>dhcp的工作方式大概是这样的，当需要加入这个网路的时候，但是确没有ip地址，则会发送bootR(bootRequest)以0.0.0.0的ip地址，发送目标地址255.255.255.255,带着自己的mac地址以广播的形式发送，这时，如果有存在dhcp server就会有相应，将加入的机器的回应以广播的形式再发送回去，还将子网掩码、网关、ip地址租用期等信息返回。如果存在多个dhcp server，一般会取收到的第一个作为回应，同样是个广播，等dhcp server确认后，才确定了信息，可以进行联网访问。</p>
<h3 id="网络拓扑结构"><a href="#网络拓扑结构" class="headerlink" title="网络拓扑结构"></a>网络拓扑结构</h3><p>简单来说，是因为局域网与局域网之间互相连接形成的比较复杂化的网络结构。交换机通过广播方式学习到网络拓扑结构。<br>网络环路的产生：机器ARP发出去的包，分别被多个交换机学，交换机在收到机器自身发送的ARP包和别的交换机发送的ARP包对应的网口位置不同造成了学习混乱，不停地发送ARP。<br>环路解决： STP协议，会根据BPDU，把其中的线路切断只保留单个交换机的链路，拆条环形后基本也就是树形结构，简称生成树协议<br>STP协议：<br><a href="https://zh.wikipedia.org/wiki/%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">STP介绍</a><br>广播问题和安全：<br>如果网络广播都是全链路发送的话，如果导致一些机密的信息被抓包，会产生一些隐患。<br><a href="https://zh.wikipedia.org/wiki/%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91" target="_blank" rel="noopener">VLAN</a><br>需要交换机支持VLAN,而层头协议上会增加一个tag字段，里面新增了vlanID，这样交换机就知道数据包发到哪里了。<br><img src="/2019/02/13/网络基础/VLAN.jpg" alt=""></p>
<h3 id="联网"><a href="#联网" class="headerlink" title="联网"></a>联网</h3><p>mac ip 头<br><img src="/2019/02/13/网络基础/ip_mac_header.jpg" alt=""><br>其实在我看来，联网其实是个查找的过程。了解下NAT<br><a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2" target="_blank" rel="noopener">NAT</a>,<br>在整个过程中，数据需要被一次又一次的转发.<br>例：<br>设备A的ip地址是192.168.1.101需要连到设备B 192.168.5.11<br>首先A、B不在一个局域网，A将包发出去，需要经过路由器转发，一般路由器的地址为该网段的第一个或者第二个<br>1.通过ARP，获取路由器连接在该设备A的端口的MAC地址<br>2.得知目标mac地址之后，发送数据包<br>3.路由器需要判断下一跳从哪里发出去，得知之后，ARP获取下一跳的MAC地址，替换目标MAC地址为下一跳<br>4.NAT改变源MAC地址和源IP地址的公网身份<br>5.反复步骤3，设备B收到数据包</p>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><p>路由需要学习，选择最短的路径自然能提高网络传输的速度,路由器与路由器之间通过相互传递，构建网络图，寻找最短距离。<br>基于bellman-ford的<a href="https://en.wikipedia.org/wiki/Distance-vector_routing_protocol" target="_blank" rel="noopener">距离矢量路由算法</a><br>基于dijkstra<a href="https://en.wikipedia.org/wiki/Link-state_routing_protocol" target="_blank" rel="noopener">链路状态路由算法</a><br>动态路由协议:<br>OSPF:<a href="https://zh.wikipedia.org/wiki/%E5%BC%80%E6%94%BE%E5%BC%8F%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88" target="_blank" rel="noopener">开放式最短路径优先</a><br>一般用于内部网络,基于链路状态路由算法。<br>BGP:<a href="https://baike.baidu.com/item/%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">外网路由协议</a><br>用于外部网络，基于距离矢量路由算法。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/25/关于生病/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/25/关于生病/" itemprop="url">关于生病</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-25T15:39:04+08:00">
                2018-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="心态"><a href="#心态" class="headerlink" title="心态"></a>心态</h2><p>生病的心态一般来讲也不会太好，反正我第一刻倒是有点懵逼的。<br>1.体检的时候，查出了一些问题，提醒我去医院复查。<br>2.周末去医院复查，约了一些检查项，检查的时候，负责B超的医生就已经告知有问题，可能需要手术<br>3.得知后懵逼一下午，然后挂了个普外科的号，去问了下医生，让我甲状腺两边全切<br>4.第一时刻也不知道是什么病，所以暂时没有答应立即住院的建议</p>
<h2 id="纠结"><a href="#纠结" class="headerlink" title="纠结"></a>纠结</h2><p>纠结于到底要不要去手术？心情也不是很好，知道有问题后，总归有点……<br>1.回家先自己查了相关资料，比如相对应类型的病症啊，有什么治疗方式等等<br>2.托朋友问了一些主治医生，是不是必须手术等等<br>3.汇合所有建议，发现只能去做手术，那也好只能躺着被割了<br>4.还差一步，通知家人相关的信息，并安排下时间照顾（当然自己很牛逼完全不需要别人照顾也OK）<br>5.预约相关比较权威的医院，找一位可以主刀的主治医师（在该病症方向），询问病情呀，手术相关的一些事宜后，安排住院流程</p>
<h2 id="住院以及手术"><a href="#住院以及手术" class="headerlink" title="住院以及手术"></a>住院以及手术</h2><p>住院很无聊<br>1.手术前要手术前检查，一般提前3天到入院<br>2.入院后，会组织相关检查<br>3.手术前一天不能吃东西<br>4.手术当天，护士也会嘱咐一些东西，遵循便是<br>5.手术当天等待手术室安排，在病房不要乱走<br>6.手术被宰割</p>
<h2 id="术后"><a href="#术后" class="headerlink" title="术后"></a>术后</h2><p>术后前期还是挺痛苦的<br>1.麻药副作用反应  总之我是比较痛苦，吐了整整一晚上，虚弱~，整整两天没吃没喝（手术前一天晚上开始）<br>2.每天固定的常规检查和挂水<br>3.手术伤口，存在活动不方便<br>4.每天安静等待。。。。。。。。。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/14/网站演进/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/14/网站演进/" itemprop="url">网站演进</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-14T15:32:56+08:00">
                2018-11-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="初始阶段网站架构"><a href="#初始阶段网站架构" class="headerlink" title="初始阶段网站架构"></a>初始阶段网站架构</h3><p>应用程序、数据库、文件系统都在一台服务器上，开搞</p>
<h3 id="应用服务和数据分离"><a href="#应用服务和数据分离" class="headerlink" title="应用服务和数据分离"></a>应用服务和数据分离</h3><p>应用程序单节点在单独的服务器上，数据库、文件系统分别在别的服务器上</p>
<h3 id="缓存改善"><a href="#缓存改善" class="headerlink" title="缓存改善"></a>缓存改善</h3><p>缓存热点数据，应用程序访问分布式缓存、或者本地缓存来提高性能</p>
<h3 id="应用服务器集群化"><a href="#应用服务器集群化" class="headerlink" title="应用服务器集群化"></a>应用服务器集群化</h3><p>当单台应用服务器满足不了性能需求之后，通过扩展应用服务，来进行伸缩，挂载负载均衡服务器来提供高性能的服务</p>
<h3 id="数据库读写分离"><a href="#数据库读写分离" class="headerlink" title="数据库读写分离"></a>数据库读写分离</h3><p>应用程序读操作会读取只读数据库，写操作时写入写数据库，读写实现主从复制，从而提高性能</p>
<h3 id="反向代理和CDN技术"><a href="#反向代理和CDN技术" class="headerlink" title="反向代理和CDN技术"></a>反向代理和CDN技术</h3><p>为了加快网站的访问，可以使用反向代理和cdn，它们的基本原理都是缓存，区别在于cdn部署在网络提供商的机房，可以让用户从离自己最近的网络机房获取数据。反向代理是部署在自己的中心机房，当发现有数据的时候，直接返回，不访问应用服务器。</p>
<h3 id="分布式数据库和分布式文件系统"><a href="#分布式数据库和分布式文件系统" class="headerlink" title="分布式数据库和分布式文件系统"></a>分布式数据库和分布式文件系统</h3><p>分布式数据库是网站数据库拆分的最后手段，只有在单表数据非常大的时候，并且没有什么很好的解决方案的时候才会考虑去做。不到万不得已的时候，网站更常用的拆分手段是按业务分库，不同的业务数据库部署在不同的服务器。</p>
<h3 id="nosql和搜索引擎"><a href="#nosql和搜索引擎" class="headerlink" title="nosql和搜索引擎"></a>nosql和搜索引擎</h3><p>当网站的存储和检索需求越来越复杂时，应用程序访问统一的数据访问模块，减轻应用程序管理多数据源的麻烦。</p>
<h3 id="业务拆分"><a href="#业务拆分" class="headerlink" title="业务拆分"></a>业务拆分</h3><p>对应用程序进行业务拆分，业务之间通过消息服务、网络等进行数据分发和存储</p>
<h3 id="业务抽象"><a href="#业务抽象" class="headerlink" title="业务抽象"></a>业务抽象</h3><p>对不同的业务，分别进行高度抽象，聚合业务，独立部署，通过分布式调度完成整体业务线</p>
<h2 id="演进小结"><a href="#演进小结" class="headerlink" title="演进小结"></a>演进小结</h2><p>不论是怎么演进，任何网站都是从小到大，没有一蹴而就的大型网站。业务与技术的相互性，业务到一定的程度会成就技术，技术的进度反之推动业务增长，提高效率等。做出最适合目前的业务的技术架构才是最合适的，随着发展慢慢的增长和扩大，更是一个健康的发展规律。</p>
<h2 id="架构模式"><a href="#架构模式" class="headerlink" title="架构模式"></a>架构模式</h2><h3 id="分层"><a href="#分层" class="headerlink" title="分层"></a>分层</h3><p>分层是单一职责的体现，尽量让项目可维护和结构化，保证业务逻辑清晰。一般来讲，计算机世界，加一层可以解决很多问题，但是也会带来一些问题，具体要在项目中去权衡利弊，总归人生都是博弈，没有博弈的架构也缺少了很多刺激。</p>
<h3 id="分割"><a href="#分割" class="headerlink" title="分割"></a>分割</h3><p>保证业务的保持在一定的颗粒度和可维护性</p>
<h3 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h3><p>分割和分层之后才更利于多部署，保证更高的可用性能，提供更可靠的服务。<br>综合考量分布式的适用情况，因为分布式也会有别的情况产生，分布式后服务调用必然通过网络，<br>这可能对性能开销也是有影响的，服务器越来越多，维护和管理也是个问题。<br>应用本身，在分布式上也存在着很多问题，不要为了分布式而分布式。<br>分布式：<br>分布式应用和服务<br>分布式静态资源<br>分布式数据和存储<br>分布式计算</p>
<h3 id="架构要素"><a href="#架构要素" class="headerlink" title="架构要素"></a>架构要素</h3><p>1.性能<br>2.可用性  4个9？哈哈哈<br>3.伸缩性<br>4.扩展性<br>5.安全性</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/24/nginx事件机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/24/nginx事件机制/" itemprop="url">nginx事件机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-24T10:41:35+08:00">
                2018-10-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ngixn事件"><a href="#ngixn事件" class="headerlink" title="ngixn事件"></a>ngixn事件</h2><p>主要是说nginx对TCP网络事件的管理，但是对于系统底层关于这块的管理又不全是一样。<br>比如linux 2.6之前的版本或unix大部分是poll或者select,2.6以后用的epoll.<br>分别对应于nginx的处理就是ngx_poll_module、ngx_select_module、ngx_epoll_module，<br>当然还有其他针对别的操作系统的事件模块。</p>
<h2 id="事件的创建"><a href="#事件的创建" class="headerlink" title="事件的创建"></a>事件的创建</h2><p>事件创建是不需要被创建的，nginx会在启动时，预分配所有的读事件和写事件，只需要调用相应的方法，往事件模块中增加或者删除事件。<br>每一个连接会对应一个读事件，一个写事件。<br>读事件：当读事件被添加到事件驱动模块中时，对应该事件的TCP连接上一旦出现可读事件就会回调该事件的handler方法。<br>写事件：当写事件被添加到事件驱动模块中，写事件被操作时，当连接对应的套接字缓冲区中有可用空间时，事件收集器会处理这个可写事件。</p>
<h2 id="ngixn对连接的定义"><a href="#ngixn对连接的定义" class="headerlink" title="ngixn对连接的定义"></a>ngixn对连接的定义</h2><p>对于web服务器，每一个用户需要至少对应一个tcp连接，一个连接至少需要一个读事件，一个写事件。同时，还会有向上游服务器（这里请了解反向代理相关概念）请求的连接，<br>ngx_ connection_ t 连接池由connections和free_connections组成，connections是指向整个连接池数组的首部，free_connection是指向第一个空闲连接,连接之间又会形成一个单链表。<br>连接与事件：连接池、读事件、写事件、分别是三个一一对应的数组根据数组序号就可以将连接和事件对应起来<br><img src="/2018/10/24/nginx事件机制/ngixn-event-1.jpg" alt=""></p>
<h2 id="核心模块"><a href="#核心模块" class="headerlink" title="核心模块"></a>核心模块</h2><p>ngx_events_module会在nginx启动时调用，会由ngx_event_core_module模块决策到底使用哪种机制去管理事件。如下图：<br><img src="/2018/10/24/nginx事件机制/nginx-event-2.jpg" alt=""></p>
<h3 id="ngx-event-core-module"><a href="#ngx-event-core-module" class="headerlink" title="ngx_event_core_module"></a>ngx_event_core_module</h3><p>1.打开accept_mutex配置，<br>2.关闭ngx_use_accept_mutex锁<br>3.初始化红黑树实现的定时器<br>4.调用配置项指定的事件模块的Init方法<br>5.指定timer_resolution毫秒后调用ngx_timer_sigal_handler方法<br>6.向cycle-&gt;files数组预分配运行时使用的连接句柄<br>7.预分配cycle-&gt;connections数组充当连接池<br>8.预分配所有读事件到cycle-&gt;read_events数组<br>9.预分配所有写事件到cycle-&gt;write_events数组<br>10.将上述3个数组中相同序号下的读写事件放置到connections连接中<br>11.讲connections数组的连接构成单链表，由cycle-&gt;free_connections指向空闲连接首部<br>12.设置监听端口上读事件的处理方法<br>13.讲监听连接的读事件添加到时间驱动模块</p>
<h3 id="epoll事件驱动模块"><a href="#epoll事件驱动模块" class="headerlink" title="epoll事件驱动模块"></a>epoll事件驱动模块</h3><p>这个模块来看一下ngx_epoll_module如何基于epoll实现nginx的事件驱动，同时可以看看如何在nginx如何在几十万并发连接下做到高效利用服务器资源的。<br>场景：有100万用户同时与一个进程保持着TCP连接，而每一时刻只有几十个或几百个TCP连接是活跃的（接收到TCP包），也就是说，在每一时刻，进程只需要处理这100万连接中的一 小部分连接。那么，如何才能高效地处理这种场景？<br>先来看看select和poll事件: 把这100万个连接告诉操作系统，然后由操作系统找出其中有事件发生的几百个连接。如果每次收集事件时，都把这100万连接的套接字传给操作系统，而由于用户态内存到内核态内存的大量复制，并且内核在寻找这些连接上没有处理事件会有很大的资源浪费。<br><a href="http://www.brendangregg.com/linuxperf.html" target="_blank" rel="noopener">附上linux图谱一张</a><br>epoll方式：将原先的select、poll方式分成了3个部分，epoll_create建立epoll对象，调用epoll_ctl向epoll对象添加这100万个连接套接字，调用epoll_wait收集发生的事件的连接，epoll_wait的效率显然非常高。所有添加到epoll中的事件都会与设备驱动程序建立回调关系。相应的事件在发生的时候会调用这里的回调方法。这个回调方法在内核中兼做ep_poll_callback，这些事件会被添加到双向链表中。epoll_wait检查是否有事件发生的连接只是检查双向链表是否存在元素而已。事件的查找是基于红黑树来实现的，也非常快。</p>
<h2 id="事件驱动框架处理流程"><a href="#事件驱动框架处理流程" class="headerlink" title="事件驱动框架处理流程"></a>事件驱动框架处理流程</h2><p>1.accept方法建立新的连接<br>2.设置负载均衡阈值<br>3.连接池中获取一个连接<br>4.为连接分配内存<br>5.设置新的套接字属性<br>6.添加连接到epoll监控<br>7.处理新连接</p>
<h3 id="解决负载群惊"><a href="#解决负载群惊" class="headerlink" title="解决负载群惊"></a>解决负载群惊</h3><p>群惊：程序开始监听web端口，fork多个子进程，这些子进程开始同时监听同一个端口，一般情况下，子进程数量和cpu核心数相同。如果没有用户连接服务器，某一个时刻恰好所有子进程都休眠且等待新连接的系统调用，这是有用户请求，内核收到SYN包后会激活所有子进程，当然，只有最开始执行accept的进程可以成功建立连接，但是其他的进程已经被唤醒了，这唤醒是不必要的浪费资源。<br>nginx在这里加了一步进程间的同步锁，只有获取到锁的进程才能监听web端口处理事件。关于锁的释放并不是在所有都处理完后释放，这样估计就单进程模式了。这边nginx是分开新连接的事件队列和普通的事件队列去解决的。区分之后会处理新连接队列，处理后立即释放锁资源。</p>
<h2 id="文件的异步IO"><a href="#文件的异步IO" class="headerlink" title="文件的异步IO"></a>文件的异步IO</h2><p>这里的文件IO也是基于Linux底层实现的。Nginx把读取文件的操作异步提交至内核后，内核会通知IO设备独立执行，这样Nginx会继续充分占用cpu，当大量读事件堆积时，电梯算法优势会被发挥，降低随机读取磁盘的成本。<br>异步的io是不会读取文件缓存的，就算当前要被读取的文件存在io设备的缓存中，也是不会去读取的，所以选择异步IO的还是要看实际应用场景。</p>
<h2 id="nginx与tcp"><a href="#nginx与tcp" class="headerlink" title="nginx与tcp"></a>nginx与tcp</h2><p><img src="/2018/10/24/nginx事件机制/nginx-event-3.jpg" alt=""><br>建立连接是在内核中完成的（上图），nginx只是从内核中获取了该连接。<br>如果accept中取出不及时，可能会导致linux的accept队列满，会影响导致syn队列满，而导致服务器无法再建立连接。</p>
<h3 id="send方法内核示意图"><a href="#send方法内核示意图" class="headerlink" title="send方法内核示意图"></a>send方法内核示意图</h3><p><img src="/2018/10/24/nginx事件机制/nginx-event-4.jpg" alt=""></p>
<h3 id="rev方法内核示意图"><a href="#rev方法内核示意图" class="headerlink" title="rev方法内核示意图"></a>rev方法内核示意图</h3><p><img src="/2018/10/24/nginx事件机制/nginx-event-5.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/18/动态代理浅说/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/18/动态代理浅说/" itemprop="url">动态代理浅说</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-18T16:08:56+08:00">
                2018-10-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>代理应该学习java的都不陌生了，不过之前我学习的时候倒是有疑问的，这么做到底意义在哪里？<br>它能帮我干些什么？</p>
<h3 id="剥离非业务逻辑"><a href="#剥离非业务逻辑" class="headerlink" title="剥离非业务逻辑"></a>剥离非业务逻辑</h3><p>举个例子，例如事务，每次使用的时候都需要打开，然后提交等操作<br>这些操作如果在每次的业务线上去做的时候，这是一件繁琐的事情，业务代码的人也并不需要关心，对于他这个角色来说，<br>处理好业务代码应该就可以了。那这部分就可以使用代理让它去帮你完成这部分操作。<br>当然spring已经封装好了，没必要再实现一遍</p>
<h3 id="制定通用的一些策略"><a href="#制定通用的一些策略" class="headerlink" title="制定通用的一些策略"></a>制定通用的一些策略</h3><p>其实这个很笼统，什么样的策略是通用，从业务上理解就是大部分场景需要这些操作，但是又不想多处维护，方式等也都比较统一的策略</p>
<h3 id="实现比较优雅的模式"><a href="#实现比较优雅的模式" class="headerlink" title="实现比较优雅的模式"></a>实现比较优雅的模式</h3><h3 id="JDK-Proxy"><a href="#JDK-Proxy" class="headerlink" title="JDK Proxy"></a>JDK Proxy</h3><p>这里其实有很多文章说明<br>实现接口 -&gt;  实现invocationHandler -&gt;  newProxyInstance  -&gt; invoke<br>newProxyInstance 这里会生成字节码 既然是动态代理总得有动态代理的意义 ^_^<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">byte[] proxyClassFile = ProxyGenerator.generateProxyClass(</span><br><span class="line">    	proxyName, interfaces.toArray(EMPTY_CLASS_ARRAY), accessFlags);</span><br><span class="line">try &#123;</span><br><span class="line">	Class&lt;?&gt; pc = UNSAFE.defineClass(proxyName, proxyClassFile,</span><br><span class="line">                                 	0, proxyClassFile.length,</span><br><span class="line">      	                           loader, null);</span><br><span class="line">	reverseProxyCache.sub(pc).putIfAbsent(loader, Boolean.TRUE);</span><br><span class="line">	return pc;</span><br><span class="line">&#125; catch (ClassFormatError e) &#123;</span><br><span class="line">// 如果出现 ClassFormatError，很可能是输入参数有问题，比如，ProxyGenerator 有 bug</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static Object newProxyInstance(ClassLoader loader,</span><br><span class="line">                                  	Class&lt;?&gt;[] interfaces,</span><br><span class="line">                                  	InvocationHandler h)</span><br></pre></td></tr></table></figure></p>
<p>ASM是通过操作字节码来实现对结构的修改和包装的。<br>如：<a href="https://en.wikipedia.org/wiki/Visitor_pattern" target="_blank" rel="noopener">Visitor</a><br><a href="http://hg.openjdk.java.net/jdk/jdk/file/29169633327c/src/java.base/share/classes/java/lang/reflect/Proxy.java" target="_blank" rel="noopener">Jdk proxy</a></p>
<h3 id="CGLIB"><a href="#CGLIB" class="headerlink" title="CGLIB"></a>CGLIB</h3><p>基于AMS的CGLIB，应该也没有人陌生<br>字节码生成子类 -&gt;  动态生成类和方法等-&gt; 包装父类和子类 -&gt; 索引代理方法和被代理方法 -&gt; 调用<br><a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html" target="_blank" rel="noopener">字节码文档</a><br><a href="https://github.com/cglib/cglib/wiki/How-To#access-the-generated-byte-array-directly" target="_blank" rel="noopener">cglib</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/18/杂说/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="怪力">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="怪力">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/18/杂说/" itemprop="url">杂说</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-18T15:59:36+08:00">
                2018-10-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于博客，之前也写过一点，但是始终没有坚持下来。<br>一是觉得墨水太少，怕辣到各位眼睛<br>二是写起来也挺烦，自我督促能力不够强<br>其实还是有必要写的，自我总结和学习嘛<br>以前写过的一些前端的小菜鸡文章就删了<br>现在开始写关于java的小菜鸡文章<br>嗯，先这样，但愿可以坚持下去</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">怪力</p>
              <p class="site-description motion-element" itemprop="description">个人博客</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">怪力</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
